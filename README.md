# 图像颜色空间分析器

一个基于Python的图像颜色空间分析工具，提供2x2四个独立的分析窗口，可以同时分析多张图片的颜色分布。

## 功能特点

### 两种工作模式

#### 1. 多块模式（2x2布局）
- **四个独立分析块**：可同时处理多张图片
- **双重显示**：每块左侧显示原图，右侧显示颜色空间统计图
- **预设降采样率**：支持1, 5, 10, 20, 50, 100等选项

#### 2. 对比模式（单图多数据）
- **单图多数据集**：在一个大图表中对比多张图片
- **不同颜色区分**：每张图片用不同颜色显示
- **自定义降采样率**：支持1-1000任意整数值输入
- **图例显示**：自动生成图例便于识别不同图片
- **灵活管理**：可逐个添加或移除图片

### 通用功能
- **多种颜色空间**：
  - r/g, b/g 空间：将RGB转换为比值形式
  - 色度空间：r/(r+g+b), g/(r+g+b) 归一化形式
- **动态坐标轴**：可手动调整或自动适应数据范围
- **图表保存**：支持将统计图保存为PNG、PDF、SVG、EPS等格式
- **多语言支持**：支持中英文界面切换
- **图片信息显示**：显示文件名、大小、尺寸等详细信息

## 安装要求

### Python版本
- Python 3.8 或更高版本

### 依赖包安装

```bash
pip install -r requirements.txt
```

或手动安装：

```bash
pip install Pillow numpy matplotlib
```

注意：`tkinter` 通常随Python一起安装，如果缺失，请根据操作系统安装：
- Ubuntu/Debian: `sudo apt-get install python3-tk`
- Fedora: `sudo dnf install python3-tkinter`
- macOS: 通常已包含在Python安装中
- Windows: 通常已包含在Python安装中

## 使用方法

### 启动程序

```bash
python image_color_analyzer.py
```

### 操作流程

#### 多块模式操作
1. **上传图片**：点击每个块中的"上传图片"按钮
2. **选择颜色空间**：选择r/g,b/g空间或色度空间
3. **设置降采样率**：从下拉菜单选择预设值
4. **调整坐标轴**：手动输入或使用"自动范围"
5. **保存图表**：点击"保存图表"按钮

#### 对比模式操作
1. **切换模式**：菜单栏 → 模式 → 对比模式
2. **设置参数**：
   - 选择颜色空间
   - 输入自定义降采样率（1-1000）
3. **添加图片**：
   - 点击"添加图片"按钮
   - 选择图片文件
   - 重复此步骤添加多张图片
4. **管理图片**：
   - 查看左侧图片列表
   - 使用"移除"按钮删除特定图片
   - 使用"清空所有"清除所有图片
5. **调整视图**：使用坐标轴控制调整显示范围
6. **保存结果**：点击"保存图表"导出对比结果

#### 通用操作
- **切换语言**：菜单栏 → 语言 → 选择中文或English
- **批量操作**（仅多块模式）：
  - 文件 → 清空所有块
  - 视图 → 刷新所有统计图
  - 视图 → 自动调整所有坐标轴

## 项目结构

```
.
├── image_color_analyzer.py    # 主程序入口
├── requirements.txt           # 依赖包列表
├── README.md                  # 本文档
└── modules/                   # 功能模块目录
    ├── __init__.py           # 包初始化文件
    ├── image_processor.py    # 图像处理核心模块
    ├── image_block.py        # 单个图片块UI组件
    └── main_window.py        # 主窗口管理模块
```

## 模块说明

### image_processor.py
- `ImageProcessor`: 图像处理核心类
  - 图像加载和格式转换
  - 降采样处理
  - RGB到r/g, b/g空间转换
  - RGB到色度空间转换

### image_block.py
- `ImageBlock`: 单个分析块组件
  - 图片上传和显示
  - 参数控制（颜色空间、降采样率）
  - 统计图绘制
  - 坐标轴范围控制

### main_window.py
- `MainWindow`: 主窗口管理
  - 2x2布局管理
  - 菜单栏功能
  - 批量操作控制
  - 状态栏显示

## 颜色空间说明

### r/g, b/g 空间
- 将RGB值转换为比值形式
- x轴：r/g（红色与绿色的比值）
- y轴：b/g（蓝色与绿色的比值）
- 适合分析颜色的相对强度关系

### 色度空间
- 归一化的颜色表示
- x轴：r/(r+g+b)（红色占总强度的比例）
- y轴：g/(r+g+b)（绿色占总强度的比例）
- 值域范围：[0, 1]
- 消除了亮度影响，只保留色度信息

## 使用建议

1. **大图片处理**：使用较高的降采样率（50-100）以提高性能
2. **对比分析**：在不同块中加载相似图片，使用相同参数进行对比
3. **颜色空间选择**：
   - 分析颜色偏向时使用r/g, b/g空间
   - 分析颜色纯度时使用色度空间
4. **坐标轴调整**：先使用"自动范围"，然后根据需要微调

## 常见问题

**Q: 程序启动失败，提示缺少tkinter？**
A: 请根据操作系统安装python3-tk包。

**Q: 处理大图片时程序卡顿？**
A: 增加降采样率，建议使用50或100。

**Q: 统计图中看不到数据点？**
A: 检查坐标轴范围设置，点击"自动范围"按钮。

**Q: 如何保存分析结果？**
A: 点击每个块下方的"保存图表"按钮，可以将统计图保存为PNG、PDF、SVG或EPS格式。

## 许可证

MIT License

## 作者

AI Assistant

## 版本历史

- v1.1.0 - 2024：添加对比模式，支持单图多数据集对比
- v1.0.0 - 2024：初始版本，支持2x2多块分析